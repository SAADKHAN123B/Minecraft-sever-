<!-- USE THIS FILE AS index.html --><!-- Updated Plugin Tab with File Upload --><!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Aternos Style Panel</title>
  <style>
    /* [Same styles as above, unchanged] */
    .plugin-file {
      margin-top: 10px;
      padding: 10px;
      background: #eee;
      border-radius: 4px;
    }
  </style>
</head>
<body><!-- LOGIN --><div id="login">
  <div class="login-box">
    <h2 style="text-align:center;">Login Panel</h2>
    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <button onclick="checkLogin()">Login</button>
    <p id="loginError"></p>
  </div>
</div><!-- PANEL --><div id="panel">
  <div class="sidebar">
    <div onclick="showTab('control')">Control</div>
    <div onclick="showTab('software')">Software</div>
    <div onclick="showTab('plugin')">Plugin</div>
    <div onclick="showTab('world')">World</div>
    <div onclick="showTab('player')">Player</div>
  </div>
  <div class="content"><!-- CONTROL -->
<div id="control" class="tab-content active">
  <h2>Server Control</h2>
  <button class="control-btn" onclick="setServerStatus('on')">Start</button>
  <button class="control-btn" onclick="setServerStatus('off')">Stop</button>
  <button class="control-btn">Restart</button>
  <p id="serverStatus" style="margin-top: 10px;"><strong>Status:</strong> OFF</p>
</div>

<!-- SOFTWARE -->
<div id="software" class="tab-content">
  <h2>Software</h2>
  <p>Click below to download PaperMC:</p>
  <button class="control-btn" onclick="window.open('https://papermc.io/downloads', '_blank')">Download PaperMC</button>
</div>

<!-- PLUGIN -->
<div id="plugin" class="tab-content">
  <h2>Plugins</h2>
  <input type="file" id="pluginUpload" accept=".jar">
  <button class="control-btn" onclick="uploadPlugin()">Upload Plugin</button>
  <div id="pluginList"></div>
</div>

<!-- WORLD -->
<div id="world" class="tab-content">
  <h2>World</h2>
  <div id="worldUpload">
    <p id="worldMsg">Server is OFF. Please turn it ON to upload a world.</p>
    <input type="file" id="worldFile" class="hidden">
    <button id="uploadBtn" class="control-btn hidden">Upload World</button>
  </div>
</div>

<!-- PLAYER -->
<div id="player" class="tab-content">
  <h2>Players</h2>
  <div class="player-buttons">
    <button class="blue-btn">âœ… Whitelist</button>
    <button class="blue-btn">ğŸ‘‘ OPs</button>
    <input type="text" id="opInput" placeholder="Enter username for OP">
    <button class="blue-btn" onclick="addOp()">Add OP</button>
    <button class="red-btn">ğŸš« Banned Players</button>
    <div id="banList">No banned players.</div>
    <button class="red-btn">ğŸš« Banned IPs</button>
  </div>

  <h3 style="margin-top:20px;">Offline Players</h3>
  <div class="offline-player">
    <div><img src="https://mc-heads.net/avatar/Steve" alt=""> DEAD</div>
    <div>â¡ï¸</div>
  </div>
  <div class="offline-player">
    <div><img src="https://mc-heads.net/avatar/Steve" alt=""> Kashish</div>
    <div>â¡ï¸</div>
  </div>
</div>

  </div>
</div><script>
  let serverOn = false;
  let ops = [];
  let bannedPlayers = [];

  function checkLogin() {
    const user = document.getElementById('username').value;
    const pass = document.getElementById('password').value;
    if (user === 'Sarkar' && pass === 'Sarkar') {
      document.getElementById('login').style.display = 'none';
      document.getElementById('panel').style.display = 'flex';
    } else {
      document.getElementById('loginError').innerText = "Invalid username or password.";
    }
  }

  function showTab(tabId) {
    document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
    document.getElementById(tabId).classList.add('active');
    if (tabId === 'world') updateWorldTab();
    if (tabId === 'player') updatePlayerTab();
    if (tabId === 'plugin') fetchPlugins();
  }

  function setServerStatus(status) {
    serverOn = (status === 'on');
    document.getElementById('serverStatus').innerHTML = `<strong>Status:</strong> ${serverOn ? 'ON' : 'OFF'}`;
    updateWorldTab();
  }

  function updateWorldTab() {
    const msg = document.getElementById('worldMsg');
    const file = document.getElementById('worldFile');
    const btn = document.getElementById('uploadBtn');

    if (serverOn) {
      msg.innerText = "Upload your world file:";
      file.classList.remove('hidden');
      btn.classList.remove('hidden');
    } else {
      msg.innerText = "Server is OFF. Please turn it ON to upload a world.";
      file.classList.add('hidden');
      btn.classList.add('hidden');
    }
  }

  function addOp() {
    const input = document.getElementById('opInput');
    const name = input.value.trim();
    if (name && !ops.includes(name)) {
      ops.push(name);
      alert(`${name} is now OP!`);
      input.value = "";
    }
  }

  function updatePlayerTab() {
    const banList = document.getElementById('banList');
    banList.innerText = bannedPlayers.length > 0 ? bannedPlayers.join(", ") : "No banned players.";
  }

  function uploadPlugin() {
    const input = document.getElementById('pluginUpload');
    const file = input.files[0];
    if (!file) return alert("Please select a plugin .jar file");

    const formData = new FormData();
    formData.append('plugin', file);

    fetch('/upload-plugin', {
      method: 'POST',
      body: formData
    })
    .then(res => res.json())
    .then(data => {
      if (data.success) {
        alert("Plugin uploaded successfully.");
        fetchPlugins();
      } else {
        alert("Failed to upload plugin.");
      }
    });
  }

  function fetchPlugins() {
    fetch('/list-plugins')
      .then(res => res.json())
      .then(data => {
        const container = document.getElementById('pluginList');
        container.innerHTML = '';
        data.plugins.forEach(p => {
          const div = document.createElement('div');
          div.className = 'plugin-file';
          div.textContent = p;
          container.appendChild(div);
        });
      });
  }
</script></body>
</html>
